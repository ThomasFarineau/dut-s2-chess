<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Plateau.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">chess-minimal-project</a> &gt; <a href="index.source.html" class="el_package">fr.iut.plateau</a> &gt; <span class="el_source">Plateau.java</span></div><h1>Plateau.java</h1><pre class="source lang-java linenums">package fr.iut.plateau;

import java.util.Arrays;

import fr.iut.pieces.Cavalier;
import fr.iut.pieces.Fou;
import fr.iut.pieces.Piece;
import fr.iut.pieces.Pion;
import fr.iut.pieces.Reine;
import fr.iut.pieces.Roi;
import fr.iut.pieces.Tour;

<span class="nc" id="L13">public class Plateau {</span>
	private boolean tourJoueur;
	private Piece[][] echiquier;

	public boolean deplacer(int x1, int y1, int x2, int y2) {
		//CODE A IMPLEMENTER

<span class="nc" id="L20">		return true;</span>
	}

	public boolean[][] calculerDeplacementsPiece(int xP, int yP) {
<span class="nc" id="L24">		boolean[][] deplacementsPlateau = new boolean[8][8]; // On cr�e la matrice retour</span>
<span class="nc bnc" id="L25" title="All 2 branches missed.">		for (boolean[] ligne : deplacementsPlateau) // On la remplit de false</span>
<span class="nc" id="L26">			Arrays.fill(ligne, false); // Ligne par ligne</span>

		// On r�cup�re les diff�rents d�placements possible de la pi�ce dont les &quot;coordonn�es&quot; sont rentr�es en param�tre
<span class="nc" id="L29">		boolean[][] deplacementsPiece = echiquier[xP][yP].getDeplacementsPoss(); </span>

<span class="nc bnc" id="L31" title="All 2 branches missed.">		if (echiquier[xP][yP] instanceof Pion) {</span>
<span class="nc bnc" id="L32" title="All 4 branches missed.">			if (echiquier[xP][yP].getCouleur() &amp;&amp; xP == 1) {</span>
<span class="nc" id="L33">				deplacementsPiece[9][7] = true;</span>
<span class="nc" id="L34">				deplacementsPiece[8][7] = false;</span>
<span class="nc" id="L35">			}</span>
				
<span class="nc bnc" id="L37" title="All 4 branches missed.">			else if (!echiquier[xP][yP].getCouleur() &amp;&amp; xP == 6) {</span>
<span class="nc" id="L38">				deplacementsPiece[5][7] = true;</span>
<span class="nc" id="L39">				deplacementsPiece[6][7] = false;</span>
			}
		}

<span class="nc bnc" id="L43" title="All 2 branches missed.">		if (echiquier[xP][yP] instanceof Cavalier) { // Algorithme pour le cavalier : pas de chemin � tracer</span>
<span class="nc bnc" id="L44" title="All 2 branches missed.">			for (int i = 0; i &lt; deplacementsPiece.length; i++) {</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">				for (int j = 0; j &lt; deplacementsPiece[0].length; j++) {</span>
<span class="nc bnc" id="L46" title="All 2 branches missed.">					if (deplacementsPiece[i][j]) { //Pour chaque d�placement</span>
<span class="nc" id="L47">						int xDeplacementPiece = xP + i - 7;</span>
<span class="nc" id="L48">						int yDeplacementPiece = yP + j - 7;</span>

<span class="nc bnc" id="L50" title="All 8 branches missed.">						if (xDeplacementPiece &gt;= 0 &amp;&amp; xDeplacementPiece &lt;= 7 &amp;&amp; yDeplacementPiece &gt;= 0 &amp;&amp; yDeplacementPiece &lt;= 7) {</span>
<span class="nc bnc" id="L51" title="All 2 branches missed.">							if (echiquier[xDeplacementPiece][yDeplacementPiece] == null)</span>
<span class="nc" id="L52">								deplacementsPlateau[xDeplacementPiece][yDeplacementPiece] = true;</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">							else if (echiquier[xDeplacementPiece][yDeplacementPiece].getCouleur() != echiquier[xP][yP].getCouleur())</span>
<span class="nc" id="L54">								deplacementsPlateau[xDeplacementPiece][yDeplacementPiece] = true;</span>
						}
					}
				}
			}
<span class="nc" id="L59">		} else {</span>
			// Calcul de la matrice retour
<span class="nc bnc" id="L61" title="All 2 branches missed.">			for (int i = 0; i &lt; deplacementsPiece.length; i++) {</span>
<span class="nc bnc" id="L62" title="All 2 branches missed.">				for (int j = 0; j &lt; deplacementsPiece[0].length; j++) {</span>
<span class="nc bnc" id="L63" title="All 2 branches missed.">					if (deplacementsPiece[i][j]) { //Pour chaque d�placement maximal</span>
						// Calcul du d�placement maximal absolu (par rapport � (0;0))
<span class="nc" id="L65">						int xDeplacementPiece = i-7;</span>
<span class="nc" id="L66">						int yDeplacementPiece = j-7;</span>

						// Calcul de la distance du d�placement unitaire (1, -1 ou 0)
<span class="nc bnc" id="L69" title="All 2 branches missed.">						int xShift = (xDeplacementPiece == 0)?0 : (xDeplacementPiece/(Math.abs(xDeplacementPiece)));</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">						int yShift = (yDeplacementPiece == 0)?0 : (yDeplacementPiece/(Math.abs(yDeplacementPiece)));</span>

						//Calcul des premiers d�placements � v�rifier
<span class="nc" id="L73">						int x = xP + xShift;</span>
<span class="nc" id="L74">						int y = yP + yShift;</span>

<span class="nc bnc" id="L76" title="All 2 branches missed.">						while ( //Tant que :</span>
<span class="nc bnc" id="L77" title="All 8 branches missed.">								(x &gt;= 0 &amp;&amp; x &lt;= 7 &amp;&amp; y &gt;= 0 &amp;&amp; y &lt;= 7) &amp;&amp;  // On reste sur l'�chiquier et qu'</span>
								// On ne d�passe pas le d�placement maximal
<span class="nc bnc" id="L79" title="All 2 branches missed.">								(Math.abs(x - xP) &lt;= Math.abs(xDeplacementPiece) &amp;&amp; (Math.abs(y - yP) &lt;= Math.abs(yDeplacementPiece))) </span>
								) {
<span class="nc bnc" id="L81" title="All 2 branches missed.">							if (echiquier[xP][yP] instanceof Pion) {</span>
<span class="nc bnc" id="L82" title="All 2 branches missed.">								if (echiquier[x][y] == null) {</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">									if (y == yP) {</span>
<span class="nc" id="L84">										deplacementsPlateau[x][y] = true;</span>
<span class="nc" id="L85">										x += xShift;</span>
<span class="nc" id="L86">									} else {</span>
<span class="nc" id="L87">										x = 8;</span>
<span class="nc" id="L88">										y = 8;</span>
									}
<span class="nc" id="L90">								} else {</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">									if (y != yP)</span>
<span class="nc bnc" id="L92" title="All 2 branches missed.">										if (echiquier[x][y].getCouleur() != echiquier[xP][yP].getCouleur())</span>
<span class="nc" id="L93">											deplacementsPlateau[x][y] = true;</span>
<span class="nc" id="L94">									x = 8;</span>
<span class="nc" id="L95">									y = 8;</span>
								}
<span class="nc" id="L97">							} else {</span>
<span class="nc bnc" id="L98" title="All 2 branches missed.">								if (echiquier[x][y] == null) { // S'il n'y a rien dans la case o� aller</span>
<span class="nc" id="L99">									deplacementsPlateau[x][y] = true; // Le d�placement unitaire est possible</span>

									// On passe au d�placement unitaire suivant (s'il existe)
<span class="nc" id="L102">									x += xShift;</span>
<span class="nc" id="L103">									y += yShift;</span>
<span class="nc" id="L104">								} else { // Sinon</span>
									// S'il y a une pi�ce de la couleur adverse, alors on peut tout de m�me y aller
<span class="nc bnc" id="L106" title="All 2 branches missed.">									if (echiquier[x][y].getCouleur() != echiquier[xP][yP].getCouleur())</span>
<span class="nc" id="L107">										deplacementsPlateau[x][y] = true;</span>

									// On a fini de calculer les d�placements pour le d�placement maximal courant
<span class="nc" id="L110">									x = 8;</span>
<span class="nc" id="L111">									y = 8;</span>
								} // Fin else
							}
						} // Fin while
					} // Fin if (deplacements...)
				} // Fin for int j
			} //Fin for int i
		}

		// On retourne la matrice des d�placements possible de la pi�ce sur le plateau
<span class="nc" id="L121">		return deplacementsPlateau;</span>
	} //Fin m�thode

	public boolean verifEchec() {
		//CODE A IMPLEMENTER

<span class="nc" id="L127">		return true;</span>
	}

	public boolean verifMat() {
		//CODE A IMPLEMENTER

<span class="nc" id="L133">		return true;</span>
	}

	@Override
	public String toString() {
<span class="nc" id="L138">		String retour=&quot;&quot;;</span>
<span class="nc bnc" id="L139" title="All 2 branches missed.">		for(int i=0; i&lt;echiquier.length; i++) {</span>
<span class="nc" id="L140">			retour += 8-i+&quot; &quot;;</span>
<span class="nc bnc" id="L141" title="All 2 branches missed.">			for(int j=0; j&lt;echiquier.length; j++) {</span>
<span class="nc bnc" id="L142" title="All 2 branches missed.">				if(echiquier[i][j] != null) {</span>
<span class="nc bnc" id="L143" title="All 2 branches missed.">					if (echiquier[i][j].toString().length()==2) {</span>
<span class="nc" id="L144">						retour+=echiquier[i][j].toString() + &quot;  &quot;;</span>
<span class="nc" id="L145">					} else {</span>
<span class="nc" id="L146">						retour+=echiquier[i][j].toString() + &quot; &quot;;</span>
					}
<span class="nc" id="L148">				} else {</span>
<span class="nc" id="L149">					retour += &quot; -  &quot;;  </span>
				}
			}
<span class="nc" id="L152">			retour += &quot;\n&quot;;</span>
		}
<span class="nc" id="L154">		retour += &quot;   A   B   C   D   E   F   G   H&quot;;</span>
<span class="nc" id="L155">		return retour;</span>
	}

	public void setEchiquier(Piece[][] echiquier) {
<span class="nc" id="L159">		this.echiquier = echiquier;</span>
<span class="nc" id="L160">	}</span>

	@Deprecated
	public String toString2() {
<span class="nc" id="L164">		String toReturn = &quot;&quot;;</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">		for (int i = 0; i &lt; echiquier.length; i++) {</span>
<span class="nc" id="L166">			toReturn += 8 - i + &quot;\t&quot;;</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">			for (int j = 0; j &lt; echiquier[i].length; j++) {</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">				if (echiquier[i][j] != null) {</span>
<span class="nc" id="L169">					toReturn += echiquier[i][j].toString() + &quot;\t&quot;;</span>
<span class="nc" id="L170">				} else {</span>
<span class="nc" id="L171">					toReturn += &quot;-\t&quot;;</span>
				}
			}
<span class="nc" id="L174">			toReturn += &quot;\n\n&quot;;</span>
		}
<span class="nc" id="L176">		toReturn += &quot;\n\tA\tB\tC\tD\tE\tF\tG\tH&quot;;</span>
<span class="nc" id="L177">		return toReturn;</span>
	}

	public static void main(String[] args) {
<span class="nc" id="L181">		Piece[][] echiquier1 = {</span>
<span class="nc" id="L182">				{new Reine(false), null, null, new Tour(false), null, null, null, new Fou(false)},</span>
<span class="nc" id="L183">				{null, null, null, null, null, new Cavalier(false), null, new Roi(true)},</span>
<span class="nc" id="L184">				{null, null, null, null, null, null, new Pion(true), new Pion(false)},</span>
<span class="nc" id="L185">				{null, null, null, null, null, null, new Pion(false), null},</span>
<span class="nc" id="L186">				{null, null, null, null, null, null, null, null},</span>
<span class="nc" id="L187">				{null, new Pion(true), null, null, null, null, null, null},</span>
<span class="nc" id="L188">				{null, new Pion(true), null, null, null, null, null, null},</span>
<span class="nc" id="L189">				{null, new Roi(false), null, null, null, null, null, null}</span>
		};

<span class="nc" id="L192">		Plateau plat = new Plateau();</span>
<span class="nc" id="L193">		plat.setEchiquier(echiquier1);</span>

<span class="nc bnc" id="L195" title="All 2 branches missed.">		for (int i = 0; i &lt; 8; i++) {</span>
<span class="nc bnc" id="L196" title="All 2 branches missed.">			for (int j = 0; j &lt; 8; j++) {</span>
<span class="nc bnc" id="L197" title="All 2 branches missed.">				if (echiquier1[i][j] != null) {</span>
<span class="nc" id="L198">					System.out.println(plat);</span>
<span class="nc" id="L199">					System.out.println(&quot;\nPiece : &quot; + echiquier1[i][j] + &quot;(&quot; + i + &quot;;&quot; + j + &quot;)&quot;);</span>
<span class="nc" id="L200">					boolean[][] dep = plat.calculerDeplacementsPiece(i, j);</span>
<span class="nc bnc" id="L201" title="All 2 branches missed.">					for (int k = 0; k &lt; 8; k++) {</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">						for (int l = 0; l &lt; 8; l++) {</span>
<span class="nc bnc" id="L203" title="All 4 branches missed.">							if (k == i &amp;&amp; l == j)</span>
<span class="nc" id="L204">								System.out.print(&quot;p &quot;);</span>
<span class="nc bnc" id="L205" title="All 2 branches missed.">							else if (dep[k][l])</span>
<span class="nc" id="L206">								System.out.print(&quot;O &quot;);</span>
							else
<span class="nc" id="L208">								System.out.print(&quot;- &quot;);</span>
						}
<span class="nc" id="L210">						System.out.println();</span>
					}
				}
			}
		}
<span class="nc" id="L215">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>